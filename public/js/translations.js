// KrishiMitra Translation System
const translations = {
    en: {
        // Navigation & General
        dashboard: "Dashboard",
        overview: "Overview",
        loans: "Loans",
        auctions: "Auctions",
        doculocker: "DocuLocker",
        transactions: "Transactions",
        settings: "Settings",
        logout: "Logout",
        
        // Homepage
        welcome: "Welcome to KrishiMitra",
        tagline: "Your Complete Agricultural Finance Ecosystem",
        subtitle: "Connecting 146 Million Farmers to ₹15 Lakh Crore Financial Opportunities",
        startJourney: "Start Your Journey",
        watchDemo: "Watch Demo",
        
        // Dashboard Stats
        totalLoans: "Total Loans",
        activeWHRs: "Active WHRs", 
        governmentSchemes: "Government Schemes",
        accountBalance: "Account Balance",
        creditScore: "Credit Score",
        farmSize: "Farm Size",
        
        // Loans Section
        applyForLoan: "Apply for Loan",
        loanAmount: "Loan Amount",
        purpose: "Purpose",
        workingCapital: "Working Capital",
        equipmentPurchase: "Equipment Purchase",
        landDevelopment: "Land Development",
        applyNow: "Apply Now",
        loanDetails: "Loan Details",
        principalAmount: "Principal Amount",
        interestRate: "Interest Rate",
        totalAmount: "Total Amount",
        remaining: "Remaining",
        makeRepayment: "Make Repayment",
        
        // Auctions
        createAuction: "Create Auction",
        cropType: "Crop Type",
        wheat: "Wheat",
        rice: "Rice", 
        cotton: "Cotton",
        basePrice: "Base Price",
        auctionDuration: "Auction Duration",
        hours: "Hours",
        startAuction: "Start Auction",
        
        // DocuLocker
        uploadDocument: "Upload Document",
        documentType: "Document Type",
        aadharCard: "Aadhaar Card",
        landRecords: "Land Records",
        bankPassbook: "Bank Passbook",
        choose: "Choose",
        chooseFile: "Choose File",
        upload: "Upload",
        
        // Government Schemes
        checkEligibility: "Check Eligibility",
        viewDetails: "View Details",
        nextPayment: "Next Payment",
        amount: "Amount",
        maxLimit: "Max Limit",
        premium: "Premium",
        claimsPaid: "Claims Paid",
        investment: "Investment",
        farmers: "Farmers",
        
        // Chatbot
        chatAssistant: "KrishiMitra Assistant",
        language: "Language",
        askAnything: "Ask me anything...",
        typing: "Typing...",
        howToGetLoans: "How to get crop loans?",
        todaysPrices: "Today's wheat prices?",
        financialHelp: "Financial planning help?",
        
        // Voice Features
        voiceInput: "Voice Input",
        listening: "Listening...",
        speak: "Speak",
        stopListening: "Stop Listening",
        
        // Common Actions
        submit: "Submit",
        cancel: "Cancel",
        save: "Save",
        delete: "Delete",
        edit: "Edit",
        view: "View",
        download: "Download",
        refresh: "Refresh",
        
        // Status
        active: "Active",
        pending: "Pending",
        completed: "Completed",
        approved: "Approved",
        rejected: "Rejected",
        
        // Messages
        success: "Success!",
        error: "Error occurred",
        loading: "Loading...",
        noDataFound: "No data found",
        sessionExpired: "Session expired. Please login again.",
        
        // Financial Planning
        financialPlanning: "Financial Planning",
        budgetPlanning: "Budget Planning",
        incomeProjection: "Income Projection",
        expenseTracking: "Expense Tracking",
        savingsGoals: "Savings Goals",
        loanEligibility: "Loan Eligibility",
        
        // Weather & Market
        weatherUpdate: "Weather Update",
        marketPrices: "Market Prices",
        temperature: "Temperature",
        humidity: "Humidity",
        rainfall: "Rainfall"
    },
    
    hi: {
        // Navigation & General
        dashboard: "डैशबोर्ड",
        overview: "अवलोकन",
        loans: "ऋण",
        auctions: "नीलामी",
        doculocker: "डॉक्यूलॉकर",
        transactions: "लेनदेन",
        settings: "सेटिंग्स",
        logout: "लॉग आउट",
        
        // Homepage
        welcome: "कृषिमित्र में आपका स्वागत है",
        tagline: "आपका संपूर्ण कृषि वित्त पारिस्थितिकी तंत्र",
        subtitle: "146 मिलियन किसानों को ₹15 लाख करोड़ के वित्तीय अवसरों से जोड़ना",
        startJourney: "अपनी यात्रा शुरू करें",
        watchDemo: "डेमो देखें",
        
        // Dashboard Stats
        totalLoans: "कुल ऋण",
        activeWHRs: "सक्रिय WHR",
        governmentSchemes: "सरकारी योजनाएं",
        accountBalance: "खाता शेष",
        creditScore: "क्रेडिट स्कोर",
        farmSize: "खेत का आकार",
        
        // Loans Section
        applyForLoan: "ऋण के लिए आवेदन करें",
        loanAmount: "ऋण राशि",
        purpose: "उद्देश्य",
        workingCapital: "कार्यशील पूंजी",
        equipmentPurchase: "उपकरण खरीद",
        landDevelopment: "भूमि विकास",
        applyNow: "अभी आवेदन करें",
        loanDetails: "ऋण विवरण",
        principalAmount: "मूल राशि",
        interestRate: "ब्याज दर",
        totalAmount: "कुल राशि",
        remaining: "शेष",
        makeRepayment: "भुगतान करें",
        
        // Auctions
        createAuction: "नीलामी बनाएं",
        cropType: "फसल प्रकार",
        wheat: "गेहूं",
        rice: "चावल",
        cotton: "कपास",
        basePrice: "आधार मूल्य",
        auctionDuration: "नीलामी अवधि",
        hours: "घंटे",
        startAuction: "नीलामी शुरू करें",
        
        // DocuLocker
        uploadDocument: "दस्तावेज़ अपलोड करें",
        documentType: "दस्तावेज़ प्रकार",
        aadharCard: "आधार कार्ड",
        landRecords: "भूमि रिकॉर्ड",
        bankPassbook: "बैंक पासबुक",
        choose: "चुनें",
        chooseFile: "फ़ाइल चुनें",
        upload: "अपलोड करें",
        
        // Government Schemes
        checkEligibility: "पात्रता जांचें",
        viewDetails: "विवरण देखें",
        nextPayment: "अगला भुगतान",
        amount: "राशि",
        maxLimit: "अधिकतम सीमा",
        premium: "प्रीमियम",
        claimsPaid: "भुगतान किए गए दावे",
        investment: "निवेश",
        farmers: "किसान",
        
        // Chatbot
        chatAssistant: "कृषिमित्र सहायक",
        language: "भाषा",
        askAnything: "कुछ भी पूछें...",
        typing: "टाइप कर रहा है...",
        howToGetLoans: "फसल ऋण कैसे लें?",
        todaysPrices: "आज गेहूं की कीमत?",
        financialHelp: "वित्तीय योजना सहायता?",
        
        // Voice Features
        voiceInput: "आवाज़ इनपुट",
        listening: "सुन रहा है...",
        speak: "बोलें",
        stopListening: "सुनना बंद करें",
        
        // Common Actions
        submit: "जमा करें",
        cancel: "रद्द करें",
        save: "सहेजें",
        delete: "मिटाएं",
        edit: "संपादित करें",
        view: "देखें",
        download: "डाउनलोड करें",
        refresh: "ताज़ा करें",
        
        // Status
        active: "सक्रिय",
        pending: "लंबित",
        completed: "पूर्ण",
        approved: "स्वीकृत",
        rejected: "अस्वीकृत",
        
        // Messages
        success: "सफलता!",
        error: "त्रुटि हुई",
        loading: "लोड हो रहा है...",
        noDataFound: "कोई डेटा नहीं मिला",
        sessionExpired: "सत्र समाप्त। कृपया फिर से लॉगिन करें।",
        
        // Financial Planning
        financialPlanning: "वित्तीय योजना",
        budgetPlanning: "बजट योजना",
        incomeProjection: "आय प्रक्षेपण",
        expenseTracking: "व्यय ट्रैकिंग",
        savingsGoals: "बचत लक्ष्य",
        loanEligibility: "ऋण पात्रता",
        
        // Weather & Market
        weatherUpdate: "मौसम अपडेट",
        marketPrices: "बाजार दर",
        temperature: "तापमान",
        humidity: "आर्द्रता",
        rainfall: "वर्षा"
    },
    
    mr: {
        // Navigation & General
        dashboard: "डॅशबोर्ड",
        overview: "सारांश",
        loans: "कर्ज",
        auctions: "लिलाव",
        doculocker: "डॉक्युलॉकर",
        transactions: "व्यवहार",
        settings: "सेटिंग्ज",
        logout: "लॉग आउट",
        
        // Homepage
        welcome: "कृषिमित्रामध्ये आपले स्वागत आहे",
        tagline: "तुमची संपूर्ण कृषी वित्त पारिस्थितिकी तंत्र",
        subtitle: "146 दशलक्ष शेतकऱ्यांना ₹15 लाख कोटी आर्थिक संधींशी जोडणे",
        startJourney: "तुमचा प्रवास सुरू करा",
        watchDemo: "डेमो पहा",
        
        // Dashboard Stats
        totalLoans: "एकूण कर्ज",
        activeWHRs: "सक्रिय WHR",
        governmentSchemes: "सरकारी योजना",
        accountBalance: "खाते शिल्लक",
        creditScore: "क्रेडिट स्कोअर",
        farmSize: "शेताचा आकार",
        
        // Loans Section
        applyForLoan: "कर्जासाठी अर्ज करा",
        loanAmount: "कर्जाची रक्कम",
        purpose: "हेतू",
        workingCapital: "कार्यरत भांडवल",
        equipmentPurchase: "उपकरणे खरेदी",
        landDevelopment: "जमीन विकास",
        applyNow: "आता अर्ज करा",
        loanDetails: "कर्जाचे तपशील",
        principalAmount: "मूळ रक्कम",
        interestRate: "व्याज दर",
        totalAmount: "एकूण रक्कम",
        remaining: "शिल्लक",
        makeRepayment: "पेमेंट करा",
        
        // Auctions
        createAuction: "लिलाव तयार करा",
        cropType: "पीक प्रकार",
        wheat: "गहू",
        rice: "तांदूळ",
        cotton: "कापूस",
        basePrice: "आधार किंमत",
        auctionDuration: "लिलाव कालावधी",
        hours: "तास",
        startAuction: "लिलाव सुरू करा",
        
        // DocuLocker
        uploadDocument: "दस्तऐवज अपलोड करा",
        documentType: "दस्तऐवज प्रकार",
        aadharCard: "आधार कार्ड",
        landRecords: "जमीन नोंदी",
        bankPassbook: "बँक पासबुक",
        choose: "निवडा",
        chooseFile: "फाइल निवडा",
        upload: "अपलोड करा",
        
        // Government Schemes
        checkEligibility: "पात्रता तपासा",
        viewDetails: "तपशील पहा",
        nextPayment: "पुढील पेमेंट",
        amount: "रक्कम",
        maxLimit: "कमाल मर्यादा",
        premium: "प्रीमियम",
        claimsPaid: "दावे भरले",
        investment: "गुंतवणूक",
        farmers: "शेतकरी",
        
        // Chatbot
        chatAssistant: "कृषिमित्र सहाय्यक",
        language: "भाषा",
        askAnything: "काहीही विचारा...",
        typing: "टाइप करत आहे...",
        howToGetLoans: "पीक कर्ज कसे घ्यावे?",
        todaysPrices: "आजचे गहूचे दर?",
        financialHelp: "आर्थिक नियोजन मदत?",
        
        // Voice Features
        voiceInput: "आवाज इनपुट",
        listening: "ऐकत आहे...",
        speak: "बोला",
        stopListening: "ऐकणे थांबवा",
        
        // Common Actions
        submit: "सबमिट करा",
        cancel: "रद्द करा",
        save: "सेव्ह करा",
        delete: "हटवा",
        edit: "संपादन करा",
        view: "पहा",
        download: "डाउनलोड करा",
        refresh: "रिफ्रेश करा",
        
        // Status
        active: "सक्रिय",
        pending: "प्रलंबित",
        completed: "पूर्ण",
        approved: "मंजूर",
        rejected: "नाकारले",
        
        // Messages
        success: "यश!",
        error: "त्रुटी झाली",
        loading: "लोड होत आहे...",
        noDataFound: "डेटा सापडला नाही",
        sessionExpired: "सत्र संपले. कृपया पुन्हा लॉगिन करा.",
        
        // Financial Planning
        financialPlanning: "आर्थिक नियोजन",
        budgetPlanning: "बजेट नियोजन",
        incomeProjection: "उत्पन्न प्रक्षेपण",
        expenseTracking: "खर्च ट्रॅकिंग",
        savingsGoals: "बचत उद्दिष्टे",
        loanEligibility: "कर्ज पात्रता",
        
        // Weather & Market
        weatherUpdate: "हवामान अपडेट",
        marketPrices: "बाजार दर",
        temperature: "तापमान",
        humidity: "आर्द्रता",
        rainfall: "पर्जन्यवृष्टी"
    }
};

// Language Management System
class LanguageManager {
    constructor() {
        this.currentLanguage = 'en';
        this.supportedLanguages = ['en', 'hi', 'mr'];
        this.init();
    }
    
    init() {
        // Load saved language preference
        const savedLang = localStorage.getItem('krishimitra_language');
        if (savedLang && this.supportedLanguages.includes(savedLang)) {
            this.currentLanguage = savedLang;
        }
        
        // Apply initial translation
        this.applyTranslations();
    }
    
    setLanguage(langCode) {
        if (!this.supportedLanguages.includes(langCode)) {
            console.error('Unsupported language:', langCode);
            return;
        }
        
        this.currentLanguage = langCode;
        localStorage.setItem('krishimitra_language', langCode);
        this.applyTranslations();
        
        // Dispatch language change event
        window.dispatchEvent(new CustomEvent('languageChanged', { 
            detail: { language: langCode } 
        }));
    }
    
    translate(key) {
        const keys = key.split('.');
        let value = translations[this.currentLanguage];
        
        for (const k of keys) {
            if (value && typeof value === 'object') {
                value = value[k];
            } else {
                // Fallback to English if translation not found
                value = translations.en;
                for (const fallbackKey of keys) {
                    if (value && typeof value === 'object') {
                        value = value[fallbackKey];
                    } else {
                        return key; // Return key if no translation found
                    }
                }
                break;
            }
        }
        
        return value || key;
    }
    
    applyTranslations() {
        // Translate all elements with data-translate attribute
        const elementsToTranslate = document.querySelectorAll('[data-translate]');
        
        elementsToTranslate.forEach(element => {
            const key = element.getAttribute('data-translate');
            const translation = this.translate(key);
            
            if (element.tagName === 'INPUT' && element.type !== 'button') {
                element.placeholder = translation;
            } else if (element.tagName === 'INPUT' && element.type === 'button') {
                element.value = translation;
            } else {
                element.textContent = translation;
            }
        });
        
        // Update language selector
        const languageSelectors = document.querySelectorAll('.language-selector');
        languageSelectors.forEach(selector => {
            selector.value = this.currentLanguage;
        });
        
        // Update page direction for RTL languages (if needed in future)
        document.documentElement.dir = 'ltr'; // All our languages are LTR
    }
    
    getCurrentLanguage() {
        return this.currentLanguage;
    }
    
    getSupportedLanguages() {
        return this.supportedLanguages;
    }
}

// Create global language manager instance
window.languageManager = new LanguageManager();

// Utility function for quick translation
window.t = function(key) {
    return window.languageManager.translate(key);
};

// Event listener for language changes
window.addEventListener('languageChanged', function(event) {
    console.log('Language changed to:', event.detail.language);
    
    // Update chatbot language if exists
    if (typeof updateChatLanguage === 'function') {
        const chatSelect = document.getElementById('chatLanguage');
        if (chatSelect) {
            chatSelect.value = event.detail.language;
            updateChatLanguage();
        }
    }
}); 